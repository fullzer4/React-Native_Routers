{"version":3,"names":["_Colors","require","_NativeReanimated","_interopRequireDefault","obj","__esModule","default","IN_STYLE_UPDATER","initialUpdaterRun","updater","result","recognizePrefixSuffix","value","match","Error","prefix","suffix","number","strippedValue","parseFloat","decorateAnimation","animation","isHigherOrder","baseOnStart","onStart","baseOnFrame","onFrame","animationCopy","Object","assign","callback","prefNumberSuffOnStart","timestamp","previousAnimation","__prefix","__suffix","strippedCurrent","strippedToValue","toValue","current","startValue","paPrefix","paSuffix","paStrippedValue","prefNumberSuffOnFrame","res","tab","colorOnStart","RGBAValue","RGBACurrent","RGBAToValue","isColor","toLinearSpace","convertToRGBA","forEach","i","index","undefined","push","rgbaArrayToRGBAColor","toGammaSpace","colorOnFrame","finished","arrayOnStart","v","arrayOnFrame","Array","isArray","IS_NATIVE","NativeReanimatedModule","native","defineAnimation","starting","factory","create","_WORKLET","cancelAnimation","sharedValue","withStartValue"],"sources":["util.ts"],"sourcesContent":["import {\n  HigherOrderAnimation,\n  NextAnimation,\n  DelayAnimation,\n  RepeatAnimation,\n  SequenceAnimation,\n  StyleLayoutAnimation,\n} from './commonTypes';\n/* global _WORKLET */\nimport {\n  ParsedColorArray,\n  isColor,\n  convertToRGBA,\n  rgbaArrayToRGBAColor,\n  toGammaSpace,\n  toLinearSpace,\n} from '../Colors';\n\nimport {\n  AnimatedStyle,\n  SharedValue,\n  AnimatableValue,\n  Animation,\n  AnimationObject,\n  Timestamp,\n} from '../commonTypes';\nimport NativeReanimatedModule from '../NativeReanimated';\n\nlet IN_STYLE_UPDATER = false;\n\nexport type UserUpdater = () => AnimatedStyle;\n\nexport function initialUpdaterRun<T>(updater: () => T): T {\n  IN_STYLE_UPDATER = true;\n  const result = updater();\n  IN_STYLE_UPDATER = false;\n  return result;\n}\n\ninterface RecognizedPrefixSuffix {\n  prefix?: string;\n  suffix?: string;\n  strippedValue: number;\n}\n\nfunction recognizePrefixSuffix(value: string | number): RecognizedPrefixSuffix {\n  'worklet';\n  if (typeof value === 'string') {\n    const match = value.match(\n      /([A-Za-z]*)(-?\\d*\\.?\\d*)([eE][-+]?[0-9]+)?([A-Za-z%]*)/\n    );\n    if (!match) {\n      throw Error(\n        \"Couldn't parse animation value. Check if there isn't any typo.\"\n      );\n    }\n    const prefix = match[1];\n    const suffix = match[4];\n    // number with scientific notation\n    const number = match[2] + (match[3] ?? '');\n    return { prefix, suffix, strippedValue: parseFloat(number) };\n  } else {\n    return { strippedValue: value };\n  }\n}\n\nfunction decorateAnimation<T extends AnimationObject | StyleLayoutAnimation>(\n  animation: T\n): void {\n  'worklet';\n  if ((animation as HigherOrderAnimation).isHigherOrder) {\n    return;\n  }\n\n  const baseOnStart = (animation as Animation<AnimationObject>).onStart;\n  const baseOnFrame = (animation as Animation<AnimationObject>).onFrame;\n  const animationCopy = Object.assign({}, animation);\n  delete animationCopy.callback;\n\n  const prefNumberSuffOnStart = (\n    animation: Animation<AnimationObject>,\n    value: string | number,\n    timestamp: number,\n    previousAnimation: Animation<AnimationObject>\n  ) => {\n    // recognize prefix, suffix, and updates stripped value on animation start\n    const { prefix, suffix, strippedValue } = recognizePrefixSuffix(value);\n    animation.__prefix = prefix;\n    animation.__suffix = suffix;\n    animation.strippedCurrent = strippedValue;\n    const { strippedValue: strippedToValue } = recognizePrefixSuffix(\n      animation.toValue as string | number\n    );\n    animation.current = strippedValue;\n    animation.startValue = strippedValue;\n    animation.toValue = strippedToValue;\n    if (previousAnimation && previousAnimation !== animation) {\n      const {\n        prefix: paPrefix,\n        suffix: paSuffix,\n        strippedValue: paStrippedValue,\n      } = recognizePrefixSuffix(previousAnimation.current as string | number);\n      previousAnimation.current = paStrippedValue;\n      previousAnimation.__prefix = paPrefix;\n      previousAnimation.__suffix = paSuffix;\n    }\n\n    baseOnStart(animation, strippedValue, timestamp, previousAnimation);\n\n    animation.current =\n      (animation.__prefix ?? '') +\n      animation.current +\n      (animation.__suffix ?? '');\n\n    if (previousAnimation && previousAnimation !== animation) {\n      previousAnimation.current =\n        (previousAnimation.__prefix ?? '') +\n        previousAnimation.current +\n        (previousAnimation.__suffix ?? '');\n    }\n  };\n  const prefNumberSuffOnFrame = (\n    animation: Animation<AnimationObject>,\n    timestamp: number\n  ) => {\n    animation.current = animation.strippedCurrent;\n    const res = baseOnFrame(animation, timestamp);\n    animation.strippedCurrent = animation.current;\n    animation.current =\n      (animation.__prefix ?? '') +\n      animation.current +\n      (animation.__suffix ?? '');\n    return res;\n  };\n\n  const tab = ['R', 'G', 'B', 'A'];\n  const colorOnStart = (\n    animation: Animation<AnimationObject>,\n    value: string | number,\n    timestamp: Timestamp,\n    previousAnimation: Animation<AnimationObject>\n  ): void => {\n    let RGBAValue: ParsedColorArray;\n    let RGBACurrent: ParsedColorArray;\n    let RGBAToValue: ParsedColorArray;\n    const res: Array<number> = [];\n    if (isColor(value)) {\n      RGBACurrent = toLinearSpace(convertToRGBA(animation.current));\n      RGBAValue = toLinearSpace(convertToRGBA(value));\n      if (animation.toValue) {\n        RGBAToValue = toLinearSpace(convertToRGBA(animation.toValue));\n      }\n    }\n    tab.forEach((i, index) => {\n      animation[i] = Object.assign({}, animationCopy);\n      animation[i].current = RGBACurrent[index];\n      animation[i].toValue = RGBAToValue ? RGBAToValue[index] : undefined;\n      animation[i].onStart(\n        animation[i],\n        RGBAValue[index],\n        timestamp,\n        previousAnimation ? previousAnimation[i] : undefined\n      );\n      res.push(animation[i].current);\n    });\n\n    animation.current = rgbaArrayToRGBAColor(\n      toGammaSpace(res as ParsedColorArray)\n    );\n  };\n\n  const colorOnFrame = (\n    animation: Animation<AnimationObject>,\n    timestamp: Timestamp\n  ): boolean => {\n    const RGBACurrent = toLinearSpace(convertToRGBA(animation.current));\n    const res: Array<number> = [];\n    let finished = true;\n    tab.forEach((i, index) => {\n      animation[i].current = RGBACurrent[index];\n      // @ts-ignore: disable-next-line\n      finished &= animation[i].onFrame(animation[i], timestamp);\n      res.push(animation[i].current);\n    });\n\n    animation.current = rgbaArrayToRGBAColor(\n      toGammaSpace(res as ParsedColorArray)\n    );\n    return finished;\n  };\n\n  const arrayOnStart = (\n    animation: Animation<AnimationObject>,\n    value: Array<number>,\n    timestamp: Timestamp,\n    previousAnimation: Animation<AnimationObject>\n  ): void => {\n    value.forEach((v, i) => {\n      animation[i] = Object.assign({}, animationCopy);\n      animation[i].current = v;\n      animation[i].toValue = (animation.toValue as Array<number>)[i];\n      animation[i].onStart(\n        animation[i],\n        v,\n        timestamp,\n        previousAnimation ? previousAnimation[i] : undefined\n      );\n    });\n\n    animation.current = value;\n  };\n\n  const arrayOnFrame = (\n    animation: Animation<AnimationObject>,\n    timestamp: Timestamp\n  ): boolean => {\n    let finished = true;\n    (animation.current as Array<number>).forEach((v, i) => {\n      // @ts-ignore: disable-next-line\n      finished &= animation[i].onFrame(animation[i], timestamp);\n      (animation.current as Array<number>)[i] = animation[i].current;\n    });\n\n    return finished;\n  };\n\n  animation.onStart = (\n    animation: Animation<AnimationObject>,\n    value: number,\n    timestamp: Timestamp,\n    previousAnimation: Animation<AnimationObject>\n  ) => {\n    if (isColor(value)) {\n      colorOnStart(animation, value, timestamp, previousAnimation);\n      animation.onFrame = colorOnFrame;\n      return;\n    } else if (Array.isArray(value)) {\n      arrayOnStart(animation, value, timestamp, previousAnimation);\n      animation.onFrame = arrayOnFrame;\n      return;\n    } else if (typeof value === 'string') {\n      prefNumberSuffOnStart(animation, value, timestamp, previousAnimation);\n      animation.onFrame = prefNumberSuffOnFrame;\n      return;\n    }\n    baseOnStart(animation, value, timestamp, previousAnimation);\n  };\n}\n\ntype AnimationToDecoration<T extends AnimationObject | StyleLayoutAnimation> =\n  T extends StyleLayoutAnimation\n    ? Record<string, unknown>\n    : T extends DelayAnimation\n    ? NextAnimation<DelayAnimation>\n    : T extends RepeatAnimation\n    ? NextAnimation<RepeatAnimation>\n    : T extends SequenceAnimation\n    ? NextAnimation<SequenceAnimation>\n    : AnimatableValue | T;\n\nconst IS_NATIVE = NativeReanimatedModule.native;\n\nexport function defineAnimation<\n  T extends AnimationObject | StyleLayoutAnimation\n>(starting: AnimationToDecoration<T>, factory: () => T): T {\n  'worklet';\n  if (IN_STYLE_UPDATER) {\n    return starting as T;\n  }\n  const create = () => {\n    'worklet';\n    const animation = factory();\n    decorateAnimation<T>(animation);\n    return animation;\n  };\n\n  if (_WORKLET || !IS_NATIVE) {\n    return create();\n  }\n  // @ts-ignore: eslint-disable-line\n  return create;\n}\n\nexport function cancelAnimation<T>(sharedValue: SharedValue<T>): void {\n  'worklet';\n  // setting the current value cancels the animation if one is currently running\n  sharedValue.value = sharedValue.value; // eslint-disable-line no-self-assign\n}\n\n// TODO it should work only if there was no animation before.\nexport function withStartValue(\n  startValue: AnimatableValue,\n  animation: NextAnimation<AnimationObject>\n): Animation<AnimationObject> {\n  'worklet';\n  return defineAnimation(startValue, () => {\n    'worklet';\n    if (!_WORKLET && typeof animation === 'function') {\n      animation = animation();\n    }\n    (animation as Animation<AnimationObject>).current = startValue;\n    return animation as Animation<AnimationObject>;\n  });\n}\n"],"mappings":"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"}